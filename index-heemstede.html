<!DOCTYPE html>
<html lang="nl">
<head><meta charset="utf-8"><title>Bevolking Heemstede</title>
<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
<style>
  body{font-family:sans-serif;background:#f9f9f9;padding:2rem;margin:0}
  .container{max-width:900px;margin:auto;background:white;padding:2rem;border-radius:12px;box-shadow:0 0 10px rgba(0,0,0,0.1)}
  .chart{margin-bottom:3rem}
</style>
</head>
<body>
  <div class="container">
    <h1>Bevolking Heemstede</h1>

    <div class="chart">
      <h2>Bevolking naar leeftijd en geslacht</h2>
      <div id="piramide"></div>
    </div>

    <div class="chart">
      <h2>Ontwikkeling totale bevolking en 65+</h2>
      <div id="aandeel"></div>
    </div>
  </div>

  <script>
    const piramideSpec = { ... }; // Jouw bestaande piramide-spec (zoals eerder)

    const aandeelSpec = {
      "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
      "width":700,"height":300,
      "data":{"url":"https://raw.githubusercontent.com/Jimvelthuis/cbs-data-heemstede-bloemendaal/main/Bevolking%20HMS%20text.txt","format":{"type":"tsv"}},
      "transform":[{"filter":"datum.Geslacht=='Totaal mannen en vrouwen'"}],
      "layer":[
        {
          "transform":[
            {"aggregate":[{"op":"sum","field":"Bevolking op 1 januari","as":"totaal"}],"groupby":["Perioden"]},
            {"calculate":"'Totale bevolking'","as":"categorie"}
          ],
          "mark":{"type":"area","opacity":0.6},
          "encoding":{
            "x":{"field":"Perioden","type":"ordinal","axis":{"title":"Jaar","labelFontSize":13,"titleFontSize":15}},
            "y":{"field":"totaal","type":"quantitative","axis":{"title":"Aantal personen","labelFontSize":13,"titleFontSize":15}},
            "color":{"field":"categorie","type":"nominal","scale":{"domain":["Totale bevolking","Bevolking 65+"],"range":["#a6cee3","#1f78b4"]},"legend":{"orient":"top","labelFontSize":14,"titleFontSize":16}},
            "tooltip":[{"field":"Perioden","title":"Jaar"},{"field":"totaal","title":"Totale bevolking"}]
          }
        },
        {
          "transform":[
            {"filter":"toNumber(datum.Leeftijd)>=65"},
            {"aggregate":[{"op":"sum","field":"Bevolking op 1 januari","as":"totaal65"}],"groupby":["Perioden"]},
            {"calculate":"'Bevolking 65+'","as":"categorie"}
          ],
          "mark":{"type":"area","opacity":0.6},
          "encoding":{
            "x":{"field":"Perioden","type":"ordinal"},
            "y":{"field":"totaal65","type":"quantitative"},
            "color":{"field":"categorie","type":"nominal"},
            "tooltip":[{"field":"Perioden","title":"Jaar"},{"field":"totaal65","title":"Bevolking 65+"}]
          }
        }
      ]
    };

    vegaEmbed("#piramide", piramideSpec, {actions:false});
    vegaEmbed("#aandeel", aandeelSpec, {actions:false});
  </script>
</body>
</html>
